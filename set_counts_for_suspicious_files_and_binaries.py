# The purpose of this script is to update the dataset with counts for suspicious binaries and files instead
# of just a list.

import os
import json
import statistics


# Function to check if a function name is suspicious
def calculate_values(list):
    ## average
    mean = sum(list) / len(list)

    median = statistics.median(list)
    return mean, median

# Define the path to the aggregated_data folder
aggregated_data_dir = 'aggregated_data'

# Iterate through JSON files in the aggregated_data folder
for filename in os.listdir(aggregated_data_dir):
    if filename.endswith('.json'):
        ## file path of data
        file_path = os.path.join(aggregated_data_dir, filename)
        # Read the JSON data from the file
        with open(file_path, 'r') as json_file:
            data = json.load(json_file)

        data['live']['persistence']['suspicious_binaries_count'] = len(data['live']['persistence']['suspicious_binaries'])
        data['live']['persistence']['suspicious_files_count'] = len(data['live']['persistence']['suspicious_files'])
        data['live']['memory']['dll_count'] = len(data['live']['memory']['dll_list'])


        # Write the updated JSON data back to the file
        with open(file_path, 'w') as json_file:
            json.dump(data, json_file, indent=4)

        print(f'Updated {filename}.')
        

print('Processing complete.')